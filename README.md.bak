The code is a mess and has not been cleaned up.